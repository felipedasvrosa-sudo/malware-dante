import os
from cryptography.fernet import Fernet

def read_key_from_file(key_filename="chave.key"):
    with open(key_filename, "rb") as chave:
        return chave.read()

# Substitua esta linha pela senha desejada
password = "Dantesec"

def decrypt_file(file_path, key, password):
    with open(file_path, "rb") as arquivo:
        conteudo = arquivo.read()
    fernet_key = Fernet(key + password.encode())
    conteudo_decrypted = fernet_key.decrypt(conteudo)
    with open(file_path, "wb") as arquivo:
        arquivo.write(conteudo_decrypted)

def decrypt_files_in_directory(directory, key, password):
    exclude_files = {"malware.py", "chave.key", "descript.py"}
    files = [file for file in os.listdir(directory) if file not in exclude_files and os.path.isfile(os.path.join(directory, file))]

    for file in files:
        file_path = os.path.join(directory, file)
        decrypt_file(file_path, key, password)

if __name__ == "__main__":
    key = read_key_from_file()

    current_directory = os.getcwd()
    decrypt_files_in_directory(current_directory, key, password)
